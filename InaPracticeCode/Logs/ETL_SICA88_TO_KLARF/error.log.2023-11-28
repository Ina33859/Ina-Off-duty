2023-11-28 09:23:05.691 - CustomFuction [ERROR   ] argument of type 'numpy.float64' is not iterable
Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 597, in file2db_init
    file, pre_params, db_src, db_tgt)
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 55, in do_file
    if '.' in x_value and len(x_value.split('.')[1]) == 3:
TypeError: argument of type 'numpy.float64' is not iterable
Stack (most recent call last):
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 138, in <module>
    do_file, before_do_file, after_do_file, skip_file, None, log, config, config_sql)
  File "../..\XdmLib\CustomFuction.py", line 631, in file2db_init
    log.error(ex, exc_info=True, stack_info=True)
2023-11-28 09:25:21.305 - CustomFuction [ERROR   ] argument of type 'float' is not iterable
Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 597, in file2db_init
    file, pre_params, db_src, db_tgt)
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 57, in do_file
    if '.' in x_value and len(x_value.split('.')[1]) == 3:
TypeError: argument of type 'float' is not iterable
Stack (most recent call last):
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 140, in <module>
    do_file, before_do_file, after_do_file, skip_file, None, log, config, config_sql)
  File "../..\XdmLib\CustomFuction.py", line 631, in file2db_init
    log.error(ex, exc_info=True, stack_info=True)
2023-11-28 09:25:21.571 - CustomFuction [ERROR   ] argument of type 'float' is not iterable
Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 597, in file2db_init
    file, pre_params, db_src, db_tgt)
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 57, in do_file
    if '.' in x_value and len(x_value.split('.')[1]) == 3:
TypeError: argument of type 'float' is not iterable
Stack (most recent call last):
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 140, in <module>
    do_file, before_do_file, after_do_file, skip_file, None, log, config, config_sql)
  File "../..\XdmLib\CustomFuction.py", line 631, in file2db_init
    log.error(ex, exc_info=True, stack_info=True)
2023-11-28 09:25:21.791 - CustomFuction [ERROR   ] argument of type 'float' is not iterable
Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 597, in file2db_init
    file, pre_params, db_src, db_tgt)
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 57, in do_file
    if '.' in x_value and len(x_value.split('.')[1]) == 3:
TypeError: argument of type 'float' is not iterable
Stack (most recent call last):
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 140, in <module>
    do_file, before_do_file, after_do_file, skip_file, None, log, config, config_sql)
  File "../..\XdmLib\CustomFuction.py", line 631, in file2db_init
    log.error(ex, exc_info=True, stack_info=True)
2023-11-28 11:07:13.513 - CustomFuction [ERROR   ] Move File Error
2023-11-28 11:07:13.516 - CustomFuction [ERROR   ] [WinError 32] 另一个程序正在使用此文件，进程无法访问。: './Data/Source\\40-4N46-DF07016.xlsx'
Traceback (most recent call last):
  File "D:\Python37\lib\shutil.py", line 557, in move
    os.rename(src, real_dst)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: './Data/Source\\40-4N46-DF07016.xlsx' -> 'Data\\Archive\\40-4N46-DF07016.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 1036, in move_file
    os.path.join(target_path, fileName))
  File "D:\Python37\lib\shutil.py", line 572, in move
    os.unlink(src)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: './Data/Source\\40-4N46-DF07016.xlsx'
Stack (most recent call last):
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 130, in <module>
    do_file, before_do_file, after_do_file, skip_file, None, log, config, config_sql)
  File "../..\XdmLib\CustomFuction.py", line 629, in file2db_init
    move_file_self(move_file_info)
  File "../..\XdmLib\CustomFuction.py", line 1044, in move_file
    log.error(ex, exc_info=True, stack_info=True)
2023-11-28 11:07:13.524 - CustomFuction [ERROR   ] [Errno 13] Permission denied: './Data/Source\\~$40-4N46-DF07016.xlsx'
Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 597, in file2db_init
    file, pre_params, db_src, db_tgt)
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 34, in do_file
    Data = pd.read_excel(file_path,engine = "openpyxl")
  File "D:\Python37\lib\site-packages\pandas\util\_decorators.py", line 296, in wrapper
    return func(*args, **kwargs)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_base.py", line 304, in read_excel
    io = ExcelFile(io, engine=engine)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_base.py", line 867, in __init__
    self._reader = self._engines[engine](self._io)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_openpyxl.py", line 480, in __init__
    super().__init__(filepath_or_buffer)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_base.py", line 353, in __init__
    self.book = self.load_workbook(filepath_or_buffer)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_openpyxl.py", line 492, in load_workbook
    filepath_or_buffer, read_only=True, data_only=True, keep_links=False
  File "D:\Python37\lib\site-packages\openpyxl\reader\excel.py", line 345, in load_workbook
    data_only, keep_links, rich_text)
  File "D:\Python37\lib\site-packages\openpyxl\reader\excel.py", line 123, in __init__
    self.archive = _validate_archive(fn)
  File "D:\Python37\lib\site-packages\openpyxl\reader\excel.py", line 95, in _validate_archive
    archive = ZipFile(filename, 'r')
  File "D:\Python37\lib\zipfile.py", line 1182, in __init__
    self.fp = io.open(file, filemode)
PermissionError: [Errno 13] Permission denied: './Data/Source\\~$40-4N46-DF07016.xlsx'
Stack (most recent call last):
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 130, in <module>
    do_file, before_do_file, after_do_file, skip_file, None, log, config, config_sql)
  File "../..\XdmLib\CustomFuction.py", line 631, in file2db_init
    log.error(ex, exc_info=True, stack_info=True)
2023-11-28 11:07:13.545 - CustomFuction [ERROR   ] Move File Error
2023-11-28 11:07:13.545 - CustomFuction [ERROR   ] [Errno 13] Permission denied: './Data/Source\\~$40-4N46-DF07016.xlsx'
Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 597, in file2db_init
    file, pre_params, db_src, db_tgt)
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 34, in do_file
    Data = pd.read_excel(file_path,engine = "openpyxl")
  File "D:\Python37\lib\site-packages\pandas\util\_decorators.py", line 296, in wrapper
    return func(*args, **kwargs)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_base.py", line 304, in read_excel
    io = ExcelFile(io, engine=engine)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_base.py", line 867, in __init__
    self._reader = self._engines[engine](self._io)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_openpyxl.py", line 480, in __init__
    super().__init__(filepath_or_buffer)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_base.py", line 353, in __init__
    self.book = self.load_workbook(filepath_or_buffer)
  File "D:\Python37\lib\site-packages\pandas\io\excel\_openpyxl.py", line 492, in load_workbook
    filepath_or_buffer, read_only=True, data_only=True, keep_links=False
  File "D:\Python37\lib\site-packages\openpyxl\reader\excel.py", line 345, in load_workbook
    data_only, keep_links, rich_text)
  File "D:\Python37\lib\site-packages\openpyxl\reader\excel.py", line 123, in __init__
    self.archive = _validate_archive(fn)
  File "D:\Python37\lib\site-packages\openpyxl\reader\excel.py", line 95, in _validate_archive
    archive = ZipFile(filename, 'r')
  File "D:\Python37\lib\zipfile.py", line 1182, in __init__
    self.fp = io.open(file, filemode)
PermissionError: [Errno 13] Permission denied: './Data/Source\\~$40-4N46-DF07016.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Python37\lib\shutil.py", line 557, in move
    os.rename(src, real_dst)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: './Data/Source\\~$40-4N46-DF07016.xlsx' -> 'Data\\ERROR\\~$40-4N46-DF07016.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "../..\XdmLib\CustomFuction.py", line 1036, in move_file
    os.path.join(target_path, fileName))
  File "D:\Python37\lib\shutil.py", line 571, in move
    copy_function(src, real_dst)
  File "D:\Python37\lib\shutil.py", line 257, in copy2
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "D:\Python37\lib\shutil.py", line 120, in copyfile
    with open(src, 'rb') as fsrc:
PermissionError: [Errno 13] Permission denied: './Data/Source\\~$40-4N46-DF07016.xlsx'
Stack (most recent call last):
  File "D:/Ina/ETL_XdmLib_2.A.13/ETL_XdmLib_2.A.13/EDAETL/ETL_TABLE/ETL_XYN_XLSX_TO_KLARF/ETL_SICA88_TO_KLARF.py", line 130, in <module>
    do_file, before_do_file, after_do_file, skip_file, None, log, config, config_sql)
  File "../..\XdmLib\CustomFuction.py", line 646, in file2db_init
    move_file_self(move_file_info)
  File "../..\XdmLib\CustomFuction.py", line 1044, in move_file
    log.error(ex, exc_info=True, stack_info=True)
